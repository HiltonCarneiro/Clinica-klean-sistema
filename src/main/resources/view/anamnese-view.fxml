<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21.0.9"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="br.com.clinica.controller.AnamneseController">

    <!-- CABEÇALHO -->
    <top>
        <VBox spacing="6">
            <padding>
                <Insets top="10" right="10" bottom="10" left="10"/>
            </padding>

            <Label fx:id="lblPaciente" text="Paciente:"/>
            <Label fx:id="lblProfissional" text="Profissional:"/>
            <Label fx:id="lblAgendamento" text="Agendamento ID:"/>

            <HBox spacing="10" alignment="CENTER_LEFT">
                <Label text="Tipo:"/>
                <ComboBox fx:id="cbTipo" prefWidth="220"/>

                <Button fx:id="btnNovaEvolucao" text="Nova evolução" onAction="#onNovaEvolucao"/>
            </HBox>
        </VBox>
    </top>

    <!-- CORPO -->
    <center>
        <SplitPane dividerPositions="0.62">
            <!-- ESQUERDA: FORMULÁRIOS -->
            <VBox spacing="10">
                <padding>
                    <Insets top="10" right="10" bottom="10" left="10"/>
                </padding>

                <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE">

                    <Tab text="Queixa / Evolução">
                        <VBox spacing="8">
                            <Label text="Queixa principal:"/>
                            <TextArea fx:id="taQueixa" prefRowCount="4" wrapText="true"/>

                            <Label text="Evolução / Observações clínicas:"/>
                            <TextArea fx:id="taEvolucao" prefRowCount="6" wrapText="true"/>

                            <Label text="Observações gerais:"/>
                            <TextArea fx:id="taObservacoes" prefRowCount="4" wrapText="true"/>
                        </VBox>
                    </Tab>

                    <Tab text="Sinais vitais">
                        <VBox spacing="8">
                            <Label text="(Em desenvolvimento)"/>
                        </VBox>
                    </Tab>

                    <Tab text="Histórico clínico">
                        <VBox spacing="8">
                            <Label text="(Em desenvolvimento)"/>
                        </VBox>
                    </Tab>

                    <Tab text="Hábitos">
                        <VBox spacing="8">
                            <Label text="(Em desenvolvimento)"/>
                        </VBox>
                    </Tab>

                    <Tab text="Exame físico">
                        <VBox spacing="8">
                            <Label text="(Em desenvolvimento)"/>
                        </VBox>
                    </Tab>

                    <!-- ✅ ABA DE ANEXOS -->
                    <Tab text="Anexos (PDF)">
                        <VBox spacing="10">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <TextField fx:id="tfDescricaoAnexo" promptText="Descrição do exame (opcional)" prefWidth="320"/>
                                <Button fx:id="btnAnexarPdf" text="Anexar PDF" onAction="#onAnexarPdf"/>
                                <Button fx:id="btnAbrirPdf" text="Abrir" onAction="#onAbrirPdf" disable="true"/>
                                <Button fx:id="btnRemoverPdf" text="Remover" onAction="#onRemoverPdf" disable="true"/>
                            </HBox>

                            <TableView fx:id="tvAnexos" prefHeight="420">
                                <columns>
                                    <TableColumn fx:id="colAnexoData" text="Data/Hora" prefWidth="170"/>
                                    <TableColumn fx:id="colAnexoArquivo" text="Arquivo" prefWidth="260"/>
                                    <TableColumn fx:id="colAnexoDescricao" text="Descrição" prefWidth="260"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </Tab>
                </TabPane>

                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Button fx:id="btnSalvarInicial" text="Salvar anamnese inicial" onAction="#onSalvarInicial"/>
                    <Button fx:id="btnSalvarEvolucao" text="Salvar evolução" onAction="#onSalvarEvolucao"/>
                </HBox>

                <Label fx:id="lblInfo" text="" style="-fx-text-fill: red;"/>
            </VBox>

            <!-- DIREITA: HISTÓRICO -->
            <VBox spacing="8">
                <padding>
                    <Insets top="10" right="10" bottom="10" left="10"/>
                </padding>

                <Label text="Histórico de anamneses / evoluções:" style="-fx-font-weight: bold;"/>
                <TableView fx:id="tvHistorico" prefHeight="600">
                    <columns>
                        <TableColumn fx:id="colData" text="Data / Hora" prefWidth="180"/>
                        <TableColumn fx:id="colTipo" text="Tipo" prefWidth="180"/>
                    </columns>
                </TableView>

                <Label text="Clique em um item para visualizar (histórico não é editável)." style="-fx-font-size: 11;"/>
            </VBox>
        </SplitPane>
    </center>

</BorderPane>